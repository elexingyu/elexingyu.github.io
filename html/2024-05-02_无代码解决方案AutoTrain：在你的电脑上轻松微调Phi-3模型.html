<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet">
</head><script>

</script>
<body><p xmlns="http://www.w3.org/1999/xhtml" style='margin-right: 8px;margin-bottom: 0px;margin-left: 8px;text-wrap: wrap;outline: 0px;background-color: rgb(255, 255, 255);font-size: 14px;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;color: rgb(63, 63, 63);visibility: visible;'><span style='outline: 0px;color: rgb(136, 136, 136);font-family: "PingFang SC";letter-spacing: 0.1em;visibility: visible;font-size: 12px;'>作者：Abhishek Thakur<br style="outline: 0px;visibility: visible;"></span></p><p xmlns="http://www.w3.org/1999/xhtml" style='margin-right: 8px;margin-bottom: 0px;margin-left: 8px;text-wrap: wrap;outline: 0px;background-color: rgb(255, 255, 255);font-size: 14px;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;color: rgb(63, 63, 63);visibility: visible;'><span style='outline: 0px;color: rgb(136, 136, 136);font-family: "PingFang SC";letter-spacing: 1.4px;visibility: visible;font-size: 12px;'>编译：活水智能</span></p><p xmlns="http://www.w3.org/1999/xhtml" style='margin-right: 8px;margin-bottom: 0px;margin-left: 8px;text-wrap: wrap;outline: 0px;background-color: rgb(255, 255, 255);font-size: 14px;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;color: rgb(63, 63, 63);visibility: visible;'><span style='outline: 0px;font-family: "PingFang SC";letter-spacing: 0.1em;color: rgb(136, 136, 136);visibility: visible;font-size: 12px;'>来源: https://huggingface.co/blog/abhishek/phi3-finetune-macbook</span></p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px; text-wrap: wrap; text-align: justify; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; margin: 1.5em 8px; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'>在这篇文章中，我会指导你如何在你的MacBook Pro上训练或微调最新的Microsoft Phi-3模型！你将需要一台配备M1或M2芯片的Mac。我们将利用AutoTrain Advanced进行操作。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-family: "PingFang SC"; font-size: 14px; text-wrap: wrap; text-align: left; line-height: 1.75; margin: 1.5em 8px; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'>首先安装AutoTrain Advanced，你可以执行以下命令：<span style='background-color: rgb(250, 250, 250); color: rgb(51, 51, 51); font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace; letter-spacing: normal; white-space-collapse: preserve; visibility: visible;'></span></p><p xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191); background: rgb(40, 44, 52); font-size: 14px; letter-spacing: normal; text-align: left; line-height: 1.5; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; overflow-x: auto; border-radius: 8px; margin: 10px 8px; visibility: visible;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace; display: -webkit-box; overflow-x: auto; line-height: 1.75; white-space-collapse: collapse; visibility: visible;'></code><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace; display: -webkit-box; overflow-x: auto; line-height: 1.75; white-space-collapse: collapse; visibility: visible;'> </code><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace; display: -webkit-box; overflow-x: auto; line-height: 1.75; white-space-collapse: collapse; visibility: visible;'> pip install autotrain-advanced</code><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace; display: -webkit-box; overflow-x: auto; line-height: 1.75; white-space-collapse: collapse; visibility: visible;'><br style="visibility: visible;"></code></p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px; text-wrap: wrap; text-align: left; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; margin: 1.5em 8px; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'>注意：安装AutoTrain不会自动安装Pytorch、Torchvision等依赖，你需要手动安装这些。建议在一个新的Conda环境中安装：<span style='color: rgb(171, 178, 191); font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; letter-spacing: normal; visibility: visible;'></span></p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191); background: rgb(40, 44, 52); font-size: 14px; letter-spacing: normal; text-align: left; line-height: 1.5; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; overflow-x: auto; border-radius: 8px; margin: 10px 8px; visibility: visible;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace; display: -webkit-box; padding: 0.5em 1em 1em; overflow-x: auto; line-height: 1.75; white-space-collapse: collapse; visibility: visible;'>$ conda create -n autotrain python=3.10<br style="visibility: visible;">$ conda activate autotrain<br style="visibility: visible;">$ conda install pytorch::pytorch torchvision torchaudio -c pytorch<br style="visibility: visible;">$ pip install autotrain-advanced</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px; text-wrap: wrap; text-align: left; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; margin: 1.5em 8px; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'><span style="display: none;line-height: 0px;">‍</span></p><p xmlns="http://www.w3.org/1999/xhtml" style='margin: 1.5em 8px; font-size: 14px; text-wrap: wrap; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'>安装完成后，你可以在你的Mac上通过命令行界面(CLI)或用户界面(UI)来使用AutoTrain！本文将介绍这两种方式。</p><p xmlns="http://www.w3.org/1999/xhtml" style='margin: 1.5em 8px;font-size: 14px;text-wrap: wrap;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>AutoTrain不仅支持大语言模型(LLM)的微调，还包括文本分类、图像分类、dreambooth lora等多种任务。本文将重点讨论微调<span style='color: rgb(63, 63, 63);font-family: -apple-system-font, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 14px;letter-spacing: 1.4px;text-wrap: wrap;'>大模型</span>。</p><p xmlns="http://www.w3.org/1999/xhtml" style='margin: 1.5em 8px;font-size: 14px;text-wrap: wrap;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>通过以下命令，你可以查看所有可调整的大模型参数：</p><p xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;margin: 10px 8px;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'> </code><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'> autotrain llm --help</code><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'><br></code></p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;'>接下来是数据获取。</span><span style='font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;letter-spacing: 0.1em;'>我将向你展示如何在你的MacBook上进行SFT训练和ORPO调优（DPO的小型版本）。</span><br></p><ul xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;list-style: circle;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p style="text-align: justify;">• 对于SFT训练，需要一个只包含单一文本列的数据集，如<span style="line-height: 1.75;color: rgb(87, 107, 149);">timdettmers/openassistant-guanaco(https://huggingface.co/datasets/timdettmers/openassistant-guanaco)</span>或类似alpaca的数据集。这些数据集已经按照系统提示、用户指令和助手消息的格式进行了组织。如果你的数据集是以下格式：</p></li></ul><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;margin: 10px 8px;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;padding: 0.5em 1em 1em;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'>[ { "content": "Definition: In this task, you need to count the number of vowels (letters 'a', 'e', 'i', 'o', 'u') / consonants (all letters other than vowels) in the given sentence.\nInput: Sentence: 'a baseball player is in his hitting stance as a few people watch'. Count the number of consonants in the given sentence.\nOutput:", "role": "user" }, { "content": "32", "role": "assistant" } ]</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>你可以利用AutoTrain的chat-template参数。我们将在本文后面讨论这个参数，但它将用于ORPO训练。因此，我们将使用预格式化的数据集进行SFT训练，并在ORPO训练中应用聊天模板。</p><ul xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;list-style: circle;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p style="text-align: justify;">•对于ORPO训练，可以使用<span style="line-height: 1.75;color: rgb(87, 107, 149);">argilla/distilabel-capybara-dpo-7k-binarized(https://huggingface.co/datasets/argilla/distilabel-capybara-dpo-7k-binarized)</span>这样的数据集，我们只关注<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">chosen</code>和<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">rejected</code>两个字段。</p></li></ul><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>在AutoTrain中，寻找或创建数据集可能是最耗时的部分。当我们准备好数据集后，可以开始SFT训练：</p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;margin: 10px 8px;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;padding: 0.5em 1em 1em;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'>autotrain llm \<br>--train \<br>--model microsoft/Phi-3-mini-4k-instruct \<br>--data-path timdettmers/openassistant-guanaco \<br>--lr 2e-4 \<br>--batch-size 2 \<br>--epochs 1 \<br>--trainer sft \<br>--peft \<br>--project-name my-own-phi-3-on-mac \<br>--username abhishek \<br>--push-to-hub \<br>--token $HF_TOKEN</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>$HF_TOKEN是你的Hugging Face写入令牌，如果你打算将训练后的模型推送到Hugging Face Hub以便共享和部署，你将需要它。你可以在<span style="line-height: 1.75;color: rgb(87, 107, 149);">这里(https://huggingface.co/settings/tokens)</span>找到你的令牌。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>请注意，我们使用了lora技术，这是为什么我们需要<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">--peft</code>参数。如果你的数据集中的文本字段不是<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">text</code>，你还可以通过<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">--text-column your_datasets_text_column</code>参数来指定。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>如果你选择使用本地CSV或JSON文件而不是Hugging Face Hub的数据集，你可以将其命名为train.csv或train.jsonl，并放在本地目录中。此时，训练命令将稍有不同：</p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;margin: 10px 8px;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;padding: 0.5em 1em 1em;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'>autotrain llm \<br>--train \<br>--model microsoft/Phi-3-mini-4k-instruct \<br>--data-path /path/to/folder/containing/training/file \<br>--text-column text_column_in_your_dataset \<br>--lr 2e-4 \<br>--batch-size 2 \<br>--epochs 1 \<br>--trainer sft \<br>--peft \<br>--project-name my-own-phi-3-on-mac \<br>--username abhishek \<br>--push-to-hub \<br>--token $HF_TOKEN</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>然后我们转到ORPO训练。对于ORPO训练，我们将<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">--trainer sft</code>改为<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">--trainer orpo</code>：</p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;margin: 10px 8px;'><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;padding: 0.5em 1em 1em;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'>autotrain llm \<br>--train \<br>--model microsoft/Phi-3-mini-4k-instruct \<br>--data-path argilla/distilabel-capybara-dpo-7k-binarized \<br>--text-column chosen \<br>--rejected-text-column rejected \<br>--lr 2e-4 \<br>--batch-size 2 \<br>--epochs 1 \<br>--trainer orpo \<br>--chat-template chatml \<br>--peft \<br>--project-name my-own-phi-3-on-mac-orpo \<br>--username abhishek \<br>--push-to-hub \<br>--token $HF_TOKEN</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>在这个命令中，主要变化是列映射和训练器的选择，以及数据集的使用。一个重要的变化是引入了<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">--chat-template</code>参数，设置为<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">chatml</code>。对于<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">--chat-template</code>，你可以选择<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">zephyr</code>、<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">chatml</code>、<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">tokenizer</code>或None。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>如果你已经按照需求格式化了数据，就可以选择None，就像我们在SFT训练中做的那样。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>如果你觉得命令行界面(CLI)操作复杂，你也可以选择使用用户界面(UI)，这更简单，还可以让你上传文件。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>要使用UI，请执行：</p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;margin: 10px 8px;'><p><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;padding: 0.5em 1em 1em;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'>$ export HF_TOKEN=your_huggingface_write_token<br></code></p><code style='font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;display: -webkit-box;padding: 0.5em 1em 1em;overflow-x: auto;line-height: 1.75;white-space-collapse: collapse;'><br>$ autotrain app --host 127.0.0.1 --port 10000</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>然后在你的浏览器中访问http://127.0.0.1:10000，享受AutoTrain的用户界面！🚀 如下图所示，这是使用上述ORPO训练参数的屏幕截图：<span style='color: rgb(87, 107, 149);font-family: "PingFang SC";letter-spacing: normal;text-align: left;'></span></p><figure xmlns="http://www.w3.org/1999/xhtml" style='line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;color: rgb(63, 63, 63);'><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-backh="336" data-backw="562" data-imgfileid="100001620" data-ratio="0.5972222222222222" data-src="https://mmbiz.qpic.cn/mmbiz_png/Oh47rXadcrd3Sk3WSLpS0fh1b5vg2Rzx4t6Djic2yhpk7JQ8TGPMEOKAw0g22cufzibMstWRMC8rwVVfFx7WgkuA/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" style='line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; border-radius: 4px; display: block; margin: 0.1em auto 0.5em; width: 661px !important; height: 394.764px !important;' title="null" data-original-style='line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;border-radius: 4px;display: block;margin: 0.1em auto 0.5em;width: 100%;height: auto;' data-index="1" src="https://mmbiz.qpic.cn/mmbiz_png/Oh47rXadcrd3Sk3WSLpS0fh1b5vg2Rzx4t6Djic2yhpk7JQ8TGPMEOKAw0g22cufzibMstWRMC8rwVVfFx7WgkuA/640?wx_fmt=png&amp;from=appmsg" _width="100%" crossorigin="anonymous" alt="图片"></figure><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: justify;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>如果在模型下拉列表中找不到phi3，你可以使用这个URL：<code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">http://127.0.0.1:7860/?custom_models=microsoft/Phi-3-mini-4k-instruct</code>。注意：我已经将phi-3添加为自定义模型。你也可以为Hub中的任何其他兼容模型进行同样的操作。;)</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>无论是SFT训练还是ORPO训练，都已在M2 Max MacBook Pro上成功测试。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>如果遇到任何问题或有功能请求，欢迎使用github repo(https://github.com/huggingface/autotrain-advanced)。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>附注：你可以在<span style="line-height: 1.75;color: rgb(87, 107, 149);">这里(https://hf.co/docs/autotrain)</span>找到AutoTrain的详细文档。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>祝你自动训练愉快！<strong style='font-family: -apple-system-font, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 14px;letter-spacing: 1.4px;text-align: left;text-wrap: wrap;line-height: 1.75;color: rgb(1, 155, 252);'>■</strong></p><section xmlns="http://www.w3.org/1999/xhtml" class="mp_profile_iframe_wrp"><mp-common-profile class="js_uneditable custom_select_card mp_profile_iframe mp_common_widget js_wx_tap_highlight" data-pluginname="mpprofile" data-id="Mzk0OTY0NzM1Ng==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/Oh47rXadcrdibxALa66icAMaGzPic3wRPiaS3iccsMu3UTBjtHiamZMlAWcf1icpRJKqEsjLQcGfMcBnD1nlUQZVickHxg/300?wx_fmt=png&amp;wxfrom=19" data-nickname="活水智能" data-alias="" data-signature="AI生产力专家。致力于通过AI教育、软件及社群提高专业知识工作者的生产力。 官网：huoshuiai.com" data-from="0" data-is_biz_ban="0" data-origin_num="61" data-isban="0" data-biz_account_status="0" data-index="0"></mp-common-profile></section><hr xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(0, 0, 0);font-family: "PingFang SC";font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;border-style: solid;border-right-width: 0px;border-bottom-width: 0px;border-left-width: 0px;border-color: rgba(0, 0, 0, 0.1);transform-origin: 0px 0px;transform: scale(1, 0.5);'><h4 xmlns="http://www.w3.org/1999/xhtml" style='font-size: 1em;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-weight: bold;margin: 2em 8px 0.5em;color: rgb(1, 155, 252);'>推荐阅读</h4><ul xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;list-style: circle;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>• <a href="https://mp.weixin.qq.com/s?__biz=Mzk0OTY0NzM1Ng==&amp;mid=2247485169&amp;idx=1&amp;sn=cd8f4d1be87702fdec14dfea200bd824&amp;scene=21#wechat_redirect" title="开源大模型太多怎么选？一文读懂，5个最好的开源大模型！" style="line-height: 1.75;" data-linktype="2">开源大模型太多怎么选？一文读懂，5个最好的开源大模型</a></p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>• <a href="https://mp.weixin.qq.com/s?__biz=Mzk0OTY0NzM1Ng==&amp;mid=2247485147&amp;idx=1&amp;sn=0028ada5db0a1dfd8b2dafa9616bee4d&amp;scene=21#wechat_redirect" title="AI21 Labs 实践经验：让大模型从“新奇玩具”到生产力工具" style="line-height: 1.75;" data-linktype="2">AI21 Labs 实践经验：让大模型从“新奇玩具”到生产力工具</a></p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>• <a href="https://mp.weixin.qq.com/s?__biz=Mzk0OTY0NzM1Ng==&amp;mid=2247485168&amp;idx=1&amp;sn=e5dc118ed7d30c02ddc1b85ce9e59d86&amp;scene=21#wechat_redirect" title="微软推出 Phi-3 Mini！性能超过两倍大小的模型" style="line-height: 1.75;" data-linktype="2">微软推出 Phi-3 Mini！性能超过两倍大小的模型</a></p></li></ul><p xmlns="http://www.w3.org/1999/xhtml" style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></body>
</html>