<html>
<head>
<title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0,viewport-fit=cover">
<style>
*{margin:0;padding:0}html{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;line-height:1.6}img{z-index:999;position:relative;max-width:100%;margin:10px 0;}body{letter-spacing:.034em}h1,h2,h3,h4,h5,h6{font-weight:400;font-size:16px}a{color:#576b95;text-decoration:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}td,th{word-wrap:break-word;padding:5px 10px;border:1px solid #DDD;}table{margin-bottom:10px;border-collapse:collapse;display:table;width:100%!important;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}.rich_media_area_primary{padding:20px 16px 12px;background-color:#fafafa}@media (max-width:375px){.rich_media_area_primary{padding:20px 60px 15px 60px}.rich_media_area_extra{padding:0 60px 21px 60px}}@media (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner,body{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media{padding:20px;overflow:hidden;}.appmsg_skin_default .rich_media_area_primary{background-color:#fff}.appmsg_skin_default .rich_media_area_primary .weui-loadmore_line .weui-loadmore__tips{background-color:#fff}@media screen and (min-width:1024px){.rich_media_area_primary_inner,.rich_media_area_extra_inner{max-width:677px;margin-left:auto;margin-right:auto}.rich_media_area_primary{padding-top:32px}}.rich_media_content{overflow:hidden;color:#333;font-size:17px;word-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;text-align:justify;position:relative;z-index:0}.rich_media_content *{max-width:100%!important;box-sizing:border-box!important;-webkit-box-sizing:border-box!important;word-wrap:break-word!important}.rich_media_content p{clear:both;min-height:1em}.rich_media_content em{font-style:italic}.rich_media_content fieldset{min-width:0}.rich_media_content .list-paddingleft-1,.rich_media_content .list-paddingleft-2,.rich_media_content .list-paddingleft-3{padding-left:2.2em}.rich_media_content .list-paddingleft-1 .list-paddingleft-2,.rich_media_content .list-paddingleft-2 .list-paddingleft-2,.rich_media_content .list-paddingleft-3 .list-paddingleft-2{padding-left:30px}.rich_media_content .list-paddingleft-1{padding-left:1.2em}.rich_media_content .list-paddingleft-3{padding-left:3.2em}.rich_media_content .code-snippet,.rich_media_content .code-snippet__fix{max-width:1000%!important}.rich_media_content .code-snippet *,.rich_media_content .code-snippet__fix *{max-width:1000%!important}.rich_media_title{font-size:22px;line-height:1.4;margin-bottom:13px;padding-bottom:13px;border-bottom:1px solid #e7e7eb;}@supports(-webkit-overflow-scrolling:touch){.rich_media_title{font-weight:700}}.rich_media_meta{display:inline-block;vertical-align:middle;padding:0 0 10px 0;font-size:15px;-webkit-tap-highlight-color:rgba(0,0,0,0)}.rich_media_meta.icon_appmsg_tag{margin-right:0px}.rich_media_meta.meta_tag_text{margin-right:0}.rich_media_meta_list em{font-style:normal}.rich_media_meta_text{color:#a5a5a5;}p{margin:0;}.msgBox{margin-top:20px;padding-top:20px;padding-left:50px;overflow:hidden;border-top:2px dashed #09a2ff;}.msg{padding-top:7px;clear:both;}.msgBody{float:right;width:100%;margin-left:55px;padding-bottom:15px;border-bottom:1px dashed #e0e0e0;}.userHeadImg{float:left;margin-left:-50px;}.userHeadImg img{width:40px;height:40px;margin-right:10px;border-radius:3px;}.userName{color:#888888;line-height:24px;font-size:14px;margin:5px 0 5px 0;height:24px;}.replyBody,.autherBody{color:#565656;font-size:15px;}.replyIcon{border-left:4px solid #33ab01;margin-right:5px;}.ad{text-decoration:none;color:#d6d4d4;font-size:12px;}.msgBodyReply{padding-top:5px;}.userName span{float:right;color:#afafaf;font-size:14px;}code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;}.code-snippet__fix{font-size:14px;margin:10px 0;display:block;color:#333;position:relative;background-color:rgba(0,0,0,0.03);border:1px solid #f0f0f0;border-radius:2px;display:-webkit-box;display:-webkit-flex;display:flex;padding-left:25px;line-height:26px}.code-snippet__fix code{text-align:left;font-size:14px;display:block;white-space:pre;display:-webkit-box;display:-webkit-flex;display:flex;position:relative;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace}.code-snippet__comment,.code-snippet__quote{color:#afafaf;font-style:italic}.code-snippet__keyword,.code-snippet__selector-tag,.code-snippet__subst{color:#ca7d37}.code-snippet__number,.code-snippet__literal,.code-snippet__variable,.code-snippet__template-variable,.code-snippet__tag .code-snippet__attr{color:#0e9ce5}.code-snippet__string,.code-snippet__doctag{color:#d14}.code-snippet__title,.code-snippet__section,.code-snippet__selector-id{color:#d14}.code-snippet__subst{font-weight:normal}.code-snippet__type,.code-snippet__class .code-snippet__title{color:#0e9ce5}.code-snippet__tag,.code-snippet__name,.code-snippet__attribute{color:#0e9ce5;font-weight:normal}.code-snippet__regexp,.code-snippet__link{color:#ca7d37}.code-snippet__symbol,.code-snippet__bullet{color:#d14}.code-snippet__built_in,.code-snippet__builtin-name{color:#ca7d37}.code-snippet__meta{color:#afafaf}.code-snippet__deletion{background:#fdd}.code-snippet__addition{background:#dfd}.code-snippet__emphasis{font-style:italic}.code-snippet__strong{font-weight:bold}.account_avatar{width:40px;height:40px;padding:0;}.account_info{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;padding:20px 0;align-items:center}.flex_bd{padding-left:14px;}.account_nickname{display:inline-block;vertical-align:middle;line-height:1.2;color:#576b95;font-size:14px}.account_desc{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;color:rgba(0,0,0,0.3);font-size:14px;line-height:1.2;padding-top:.4em}.msg_source_url{text-align:left;word-break:break-all;margin-top:20px;}.msg_source_url a{padding-right:10px;}.msg_source_url .url_text{color:#a8a8a8;}.video-desc{font-size:14px;margin-top:15px;color:#6c6c6c;}.msg_source_url{text-align:left;}.original_primary_card_tips{color:rgba(0,0,0,0.3);line-height:1.4;font-size:15px;}.weui-flex__item{margin-bottom:20px;padding:20px 16px;margin-top:16px;line-height:1.4;align-items:center;background-color:#f7f7f7;border-radius:8px;position:relative;}.original_primary_desc{color:rgba(0,0,0,0.5);font-size:14px;padding-top:4px;width:auto;overflow:hidden;text-overflow:ellipsis;}.msgBodyReplyList{border-top:1px solid #e1e1e1;margin-top:10px;}.msgBodyReplyListTop{border-top:0;}.reply_like_num{float:right;font-size:14px;color:#c7c7c7;}.msgData{margin-top:20px;color:#626262;}.msgData span{font-size:14px;padding-right:15px;}.msgData .likes{float:right;padding-right:0;}.js_text_content p{font-size:18px;}.rich_media_meta_link{font-size:15px;}blockquote {padding-left: 10px;border-left: 3px solid #dbdbdb;color: rgba(0,0,0,0.5);font-size: 15px;padding-top: 4px;margin: 1em 0;}.video_iframe{width:500px;height:400px;}.blockquote_info{color:#b5b5b5;margin-top:10px;}#copyright_logo{color:#bdbdbd;}.rich_media_meta_list{margin-bottom:10px;}.reprint{background:#efefef;border-radius:5px;padding:8px;color:#1f1f1f;}.reprint a{word-break:break-all;}.topic{color:#8e8e8e;background:#f7f7f7;border-radius:5px;padding:10px 8px;}.topic a{padding-right:5px;}.topic p{margin-bottom:5px;}
</style>
<link href="https://www.juyifx.cn/config/css/wxArticle.css" rel="stylesheet">
</head><script>

</script>
<body><h1 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal; text-wrap: wrap; text-align: center; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; font-size: 15.96px; font-weight: bold; display: table; margin: 2em auto 1em; padding-right: 1em; padding-left: 1em; border-bottom: 2px solid rgb(15, 76, 129); color: rgb(63, 63, 63); visibility: visible;'>前    言</h1><p xmlns="http://www.w3.org/1999/xhtml" style='font-family: "PingFang SC"; font-size: 14px; text-wrap: wrap; text-align: left; line-height: 1.75; margin: 1.5em 8px; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'>在《231026 llama.cpp 极简》中，我介绍了使用 llama.cpp 来推理模型。如今，一个新的框架横空出世。<span style="line-height: 1.75; color: rgb(87, 107, 149); visibility: visible;">MLX</span> 是专为苹果芯片（即你的 MacBook 或 Mac Studio！）而设计的高效机器学习框架。在短短的一周时间里已经斩获了 8000 Stars。</p><p xmlns="http://www.w3.org/1999/xhtml" style="text-align: center; visibility: visible;"><img class="rich_pages wxw-img js_insertlocalimg" data-backh="241" data-backw="578" data-imgfileid="100001260" data-ratio="0.41759259259259257" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrgfkiaKdxCpuwc89bibc02Jqmqeib9LG96blRHxh94wvibz14RtM8TLTIzw/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" style="width: 677px !important; height: auto !important; visibility: visible !important;" data-original-style="width: 100%;height: auto;" data-index="1" src="https://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrgfkiaKdxCpuwc89bibc02Jqmqeib9LG96blRHxh94wvibz14RtM8TLTIzw/640?wx_fmt=jpeg&amp;from=appmsg" _width="100%" crossorigin="anonymous" alt="图片" data-fail="0"></p><h1 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal; text-wrap: wrap; text-align: center; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; font-size: 15.96px; font-weight: bold; display: table; margin: 2em auto 1em; padding-right: 1em; padding-left: 1em; border-bottom: 2px solid rgb(15, 76, 129); color: rgb(63, 63, 63); visibility: visible;'>MLX 与 PyTorch 的区别</h1><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px; text-wrap: wrap; text-align: left; line-height: 1.75; font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; margin: 1.5em 8px; letter-spacing: 0.1em; color: rgb(63, 63, 63); visibility: visible;'>MLX 和其他框架的一个显著区别对统一内存的原生支持。在 MLX 中，数组存在于共享内存中，比如对于下面这段代码。</p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin: 10px 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'>a = mx.random.normal((100,))<br>b = mx.random.normal((100,))<br>mx.add(a, b, stream=mx.cpu)<br>mx.add(a, b, stream=mx.gpu)</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>变量 a 和 b 是没有副本的，虽然是在 cpu 和 gpu 这两个不同的设备上运行。而这个改进在 PyTorch 里较难实现。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>MLX 的数组 API 与 Numpy 是一致的，有点像 Jax，这让调试变得十分容易。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>框架总是越变越复杂，MLX 提供了一个很小的起点，对于想要探索新的想法的人，是一个很好的起点，比如对于没有丰富框架经验的研究者来说，通过 MLX 查询 Stack 是很容易的。同样，你也可以轻松地添加 Metal（GPU）内核来尝试新的优化。</p><h1 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.96px;font-weight: bold;display: table;margin: 2em auto 1em;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);color: rgb(63, 63, 63);'>案    例</h1><h2 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.4px;font-weight: bold;display: table;margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);color: rgb(255, 255, 255);'>使用苹果芯片微调与推理 Llama-7B 模型</h2><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>在 https://github.com/ml-explore/mlx-examples/tree/main/lora 这个案例中，作者使用 M2 Ultra LoRA 微调 Llama-7B。使用的数据集是 WikiSQL 在使用 MLX 框架时模型 1s 能看 475 个 Tokens 这是个较为可观的速度。考虑到苹果芯片的功率远远低于 N 卡。</p><p xmlns="http://www.w3.org/1999/xhtml" style="text-align: center;"><img class="rich_pages wxw-img js_insertlocalimg js_img_placeholder wx_img_placeholder" data-backh="310" data-backw="578" data-imgfileid="100001261" data-ratio="0.5361111111111111" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrHnyibT4O9vC35vcibgrTgJHV7yrLwcdBQ6X2vxJqhbReFFn1OjjNcdkg/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" style="width: 677px !important; height: 362.947px !important;" data-original-style="width: 100%;height: auto;" data-index="2" src="https://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrHnyibT4O9vC35vcibgrTgJHV7yrLwcdBQ6X2vxJqhbReFFn1OjjNcdkg/640?wx_fmt=jpeg&amp;from=appmsg" _width="100%" crossorigin="anonymous" alt="图片"></p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>敝人也在第一时间使用了 M2 Max LoRA 微调 Llama-2-7B，此时：</p><ol xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>1. 可训练的参数量为 2,090,000，大约为模型的 1%。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>2. 使用 28m24s 分钟学习 426,000 个 Tokens。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>3. 数据来源于 wikisql。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p><br></p><p style="text-align: center;"><img class="rich_pages wxw-img js_insertlocalimg js_img_placeholder wx_img_placeholder" data-backh="339" data-backw="547" data-imgfileid="100001262" data-ratio="0.6185185185185185" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrFeekFhhIGCFJnKvNISEiaZRFbicjVVnfldA1X9XjIhpsVqE6N04v3IPA/640?wx_fmt=jpeg&amp;from=appmsg" data-type="jpeg" data-w="1080" style="width: 647px !important; height: 400.181px !important;" data-original-style="width: 100%;height: auto;" data-index="3" src="https://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrFeekFhhIGCFJnKvNISEiaZRFbicjVVnfldA1X9XjIhpsVqE6N04v3IPA/640?wx_fmt=jpeg&amp;from=appmsg" _width="100%" crossorigin="anonymous" alt="图片"></p><p style="text-align: center;margin-bottom: 16px;margin-top: 8px;"><span style="font-family: 宋体;font-size: 16px;letter-spacing: normal;text-align: -webkit-left;text-wrap: wrap;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);">▲</span><span style="color: rgb(136, 136, 136);"><span style="color: rgb(0, 0, 0);font-family: 宋体;font-size: 16px;letter-spacing: normal;text-align: -webkit-left;text-wrap: wrap;background-color: rgb(255, 255, 255);"> </span>训练时的内存占用</span></p></li></ol><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin: 10px 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'>Loading tokenizer<br>Loading pretrained model<br>Total parameters 6740.513M<br>Trainable parameters 2.097M<br>Loading datasets<br>Training<br>Iter 1: Val loss 2.631, Val took 87.426s<br>Iter 10: Train loss 2.570, It/sec 0.716, Tokens/sec 290.433<br>Iter 20: Train loss 2.515, It/sec 0.628, Tokens/sec 258.048<br>Iter 30: Train loss 2.506, It/sec 0.666, Tokens/sec 265.094<br>Iter 40: Train loss 2.396, It/sec 0.709, Tokens/sec 273.973<br>Iter 50: Train loss 2.107, It/sec 0.336, Tokens/sec 140.164<br>Iter 60: Train loss 1.891, It/sec 0.357, Tokens/sec 149.226<br>Iter 70: Train loss 1.765, It/sec 0.515, Tokens/sec 218.188<br>Iter 80: Train loss 1.633, It/sec 0.560, Tokens/sec 241.879<br>Iter 90: Train loss 1.659, It/sec 0.723, Tokens/sec 274.657<br>Iter 100: Train loss 1.464, It/sec 0.693, Tokens/sec 279.841<br>Iter 110: Train loss 1.458, It/sec 0.287, Tokens/sec 119.309<br>Iter 120: Train loss 1.430, It/sec 0.695, Tokens/sec 282.145<br>Iter 130: Train loss 1.351, It/sec 0.723, Tokens/sec 284.272<br>Iter 140: Train loss 1.296, It/sec 0.371, Tokens/sec 153.476<br>Iter 150: Train loss 1.289, It/sec 0.289, Tokens/sec 125.269<br>Iter 160: Train loss 1.227, It/sec 0.638, Tokens/sec 267.037<br>Iter 170: Train loss 1.297, It/sec 0.673, Tokens/sec 263.027<br>Iter 180: Train loss 1.260, It/sec 0.747, Tokens/sec 298.913<br>Iter 190: Train loss 1.301, It/sec 0.667, Tokens/sec 272.906<br>Iter 200: Train loss 1.208, It/sec 0.679, Tokens/sec 274.468<br>Iter 200: Val loss 1.367, Val took 89.204s<br>Iter 210: Train loss 1.253, It/sec 0.218, Tokens/sec 90.227<br>Iter 220: Train loss 1.252, It/sec 0.405, Tokens/sec 159.813<br>Iter 230: Train loss 1.209, It/sec 0.671, Tokens/sec 275.411<br>Iter 240: Train loss 1.133, It/sec 0.274, Tokens/sec 111.109<br>Iter 250: Train loss 1.171, It/sec 0.683, Tokens/sec 281.772<br>Iter 260: Train loss 1.204, It/sec 0.567, Tokens/sec 223.330<br>Iter 270: Train loss 1.186, It/sec 0.753, Tokens/sec 288.255<br>Iter 280: Train loss 1.206, It/sec 0.418, Tokens/sec 178.632<br>Iter 290: Train loss 1.219, It/sec 0.703, Tokens/sec 278.136<br>Iter 300: Train loss 1.279, It/sec 0.688, Tokens/sec 284.234<br>Iter 310: Train loss 1.150, It/sec 0.718, Tokens/sec 285.111<br>Iter 320: Train loss 1.133, It/sec 0.411, Tokens/sec 166.316<br>Iter 330: Train loss 1.131, It/sec 0.657, Tokens/sec 276.787<br>Iter 340: Train loss 1.115, It/sec 0.345, Tokens/sec 139.521<br>Iter 350: Train loss 1.107, It/sec 0.394, Tokens/sec 152.985<br>Iter 360: Train loss 1.148, It/sec 0.671, Tokens/sec 265.895<br>Iter 370: Train loss 1.118, It/sec 0.222, Tokens/sec 93.099<br>Iter 380: Train loss 1.218, It/sec 0.609, Tokens/sec 254.048<br>Iter 390: Train loss 1.123, It/sec 0.626, Tokens/sec 253.893<br>Iter 400: Train loss 1.179, It/sec 0.697, Tokens/sec 279.039<br>Iter 400: Val loss 1.269, Val took 84.119s<br>Iter 410: Train loss 1.111, It/sec 0.701, Tokens/sec 279.082<br>Iter 420: Train loss 1.123, It/sec 0.595, Tokens/sec 243.557<br>Iter 430: Train loss 1.113, It/sec 0.657, Tokens/sec 268.686<br>Iter 440: Train loss 1.046, It/sec 0.298, Tokens/sec 123.639<br>Iter 450: Train loss 1.034, It/sec 0.596, Tokens/sec 236.784<br>Iter 460: Train loss 1.096, It/sec 0.666, Tokens/sec 265.193<br>Iter 470: Train loss 1.197, It/sec 0.698, Tokens/sec 279.153<br>Iter 480: Train loss 1.087, It/sec 0.728, Tokens/sec 288.371<br>Iter 490: Train loss 1.040, It/sec 0.335, Tokens/sec 140.192<br>Iter 500: Train loss 1.052, It/sec 0.120, Tokens/sec 52.068<br>Iter 510: Train loss 1.094, It/sec 0.670, Tokens/sec 279.862<br>Iter 520: Train loss 1.084, It/sec 0.657, Tokens/sec 269.986<br>Iter 530: Train loss 1.113, It/sec 0.651, Tokens/sec 252.181<br>Iter 540: Train loss 1.111, It/sec 0.618, Tokens/sec 248.848<br>Iter 550: Train loss 1.181, It/sec 0.617, Tokens/sec 248.874<br>Iter 560: Train loss 1.162, It/sec 0.627, Tokens/sec 268.917<br>Iter 570: Train loss 1.111, It/sec 0.127, Tokens/sec 50.557<br>Iter 580: Train loss 1.189, It/sec 0.166, Tokens/sec 67.234<br>Iter 590: Train loss 1.075, It/sec 0.728, Tokens/sec 282.522<br>Iter 600: Train loss 1.100, It/sec 0.680, Tokens/sec 278.370<br>Iter 600: Val loss 1.232, Val took 85.148s<br>耗时 28m24s。</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style="text-align: center;"><br></p><p xmlns="http://www.w3.org/1999/xhtml" style="text-align: center;"><img class="rich_pages wxw-img js_insertlocalimg js_img_placeholder wx_img_placeholder" data-backh="416" data-backw="578" data-imgfileid="100001263" data-ratio="0.7203703703703703" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrHj67A2RibPWUq4Nv35N4vFicUKpv9vibia08gbcmYpwUrRlESRCsIenRpQ/640?wx_fmt=png&amp;from=appmsg" data-type="png" data-w="1080" style="width: 677px !important; height: 487.691px !important;" data-original-style="width: 100%;height: auto;" data-index="4" src="https://mmbiz.qpic.cn/mmbiz_png/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrHj67A2RibPWUq4Nv35N4vFicUKpv9vibia08gbcmYpwUrRlESRCsIenRpQ/640?wx_fmt=png&amp;from=appmsg" _width="100%" crossorigin="anonymous" alt="图片"></p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 8px 8px 16px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'><span style="letter-spacing: normal;text-indent: -14px;text-wrap: wrap;font-family: 宋体;font-size: 16px;text-align: -webkit-left;background-color: rgb(255, 255, 255);color: rgb(136, 136, 136);">▲</span><span style="letter-spacing: normal;text-indent: -14px;text-wrap: wrap;color: rgb(0, 0, 0);font-family: 宋体;font-size: 16px;text-align: -webkit-left;background-color: rgb(255, 255, 255);"> </span><span style="color: rgb(136, 136, 136);">使用训练后的 Adapt 层来推理模型</span></p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>在训练 28m 后可以使用自带的推理脚本来推理模型，如上图所示，模型已经部分学会了 SQL 语言。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>下面的两个 Shell 脚本是使用官方的 lora.py 来训练与推理模型的教程，你需要的做的是：</p><ol xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>1. 把官方的 mlx-examples 仓库克隆到本地。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>2. 安装对应的 Python 依赖。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>3. 下载并转换训练的模型为 npz 格式。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p><br></p></li></ol><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin: 10px 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'><span style="color: rgb(230, 192, 123);">export</span> MLX_PATH=<span style="color: rgb(152, 195, 121);">""</span> <span style="color: rgb(92, 99, 112);font-style: italic;"># 这里填写你克隆在本地的 https://github.com/ml-explore/mlx-examples/</span><br><span style="color: rgb(230, 192, 123);">export</span> MODEL_PATH=<span style="color: rgb(152, 195, 121);">""</span> <span style="color: rgb(92, 99, 112);font-style: italic;"># 这里填写你下载并转换为 npz 格式的 llama 模型路径</span><br><br>python <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MLX_PATH</span>"</span>/lora/lora.py \<br>  --model <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MODEL_PATH</span>"</span>/mlx_llama_weights.npz \<br>  --tokenizer <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MODEL_PATH</span>"</span>/tokenizer.model \<br>  --train \<br>  --iters 600 \<br>  --adapter_file <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MODEL_PATH</span>"</span>/adapters.npz</code></pre><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin: 10px 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'><span style="color: rgb(230, 192, 123);">export</span> MLX_PATH=<span style="color: rgb(152, 195, 121);">""</span> <span style="color: rgb(92, 99, 112);font-style: italic;"># 这里填写你克隆在本地的 https://github.com/ml-explore/mlx-examples/</span><br><span style="color: rgb(230, 192, 123);">export</span> MODEL_PATH=<span style="color: rgb(152, 195, 121);">""</span> <span style="color: rgb(92, 99, 112);font-style: italic;"># 这里填写你下载并转换为 npz 格式的 llama 模型路径</span><br><br>python <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MLX_PATH</span>"</span>/lora/lora.py \<br>--model <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MODEL_PATH</span>"</span>/mlx_llama_weights.npz \<br>--tokenizer <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MODEL_PATH</span>"</span>/tokenizer.model \<br>--adapter_file <span style="color: rgb(152, 195, 121);">"<span style="color: rgb(209, 154, 102);">$MODEL_PATH</span>"</span>/adapters.npz \<br>--num-tokens 50 \<br>--prompt <span style="color: rgb(152, 195, 121);">"table: 1-10015132-16<br>columns: Player, No., Nationality, Position, Years in Toronto, School/Club Team<br>Q: What is terrence ross' nationality<br>A: "</span></code></pre><h2 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.4px;font-weight: bold;display: table;margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);color: rgb(255, 255, 255);'>使用苹果芯片推理 Mistral-7B 模型</h2><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>备注一：<span style="line-height: 1.75;color: rgb(87, 107, 149);">Mistral-7B</span> 是个开源模型。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>备注二：非量化版本。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>下面是运行模型的示范视频。</p><section xmlns="http://www.w3.org/1999/xhtml"><span data-vw="677" data-vh="507.75" height="520" width="677" data-src="https://mp.weixin.qq.com/mp/readtemplate?t=pages/video_player_tmpl&amp;auto=0&amp;vid=wxv_3234562720833503239" style="border-radius: 4px; width: 677px !important; height: 520px !important; overflow: hidden;" data-w="640" data-ratio="1.4285714285714286" frameborder="0" allowfullscreen="" data-cover="http%3A%2F%2Fmmbiz.qpic.cn%2Fmmbiz_jpg%2FqbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrAl1KeVH35bVfScboAzw81eRjfQpz5CSWG1ll03WrgOWAibz4x7icGUCg%2F0%3Fwx_fmt%3Djpeg" data-mpvid="wxv_3234562720833503239" data-vidtype="2" class="video_iframe rich_pages" id="js_mp_video_container_0" vid="wxv_3234562720833503239" scrolling="no"><div id="page-content">   <!--S 全屏播放 full_screen_mv-->   <div id="js_mpvedio_wrapper_wxv_3234562720833503239" style="position:relative;height:100%">     <div class="add_bg_color appmsg_video">       <div id="js_video_tail_panel_wxv_3234562720833503239" class="video_tail_module video_screen_half" style="display: none;">         <div class="video_tail_module__hd" id="js_video_tail_hd">           <div class="account_info_wrp">             <div class="profile_info_wrp js_go_profile">               <img class="account_avatar" src="" alt="" id="js_tail_panel_account_avatar">                 <div class="account_name" id="js_tail_panel_account_name"></div>                 <div class="subscription_info subscription_success">                   <div class="account_subscription_tips js_subscription_success" id="js_subscription_success" style="display: none;">已关注</div>                   <i class="account_link_icon js_profile_icon" id="js_profile_icon"></i>                 </div>             </div>             <div class="btn_account_subscription js_btn_account_subscription" id="js_btn_account_subscription" style="display: none;">               关注</div>           </div>           <div class="opr_wrp">             <span class="opr_item_wrp js_replay" id="js_replay">               <i class="opr_item refresh_icon"></i>               <span class="opr_item_text">重播</span>             </span>             <span class="opr_item_wrp share_item_wrp js_share_button" id="js_tail_share_button" style="display: none;">               <i class="opr_item share_icon"></i>               <span class="opr_item_text">分享</span>             </span>             <!--点赞后 加className selected-->             <span class="opr_item_wrp like_item_wrp" id="js_tail_like_button" style="display: none;">               <i class="opr_item like_icon"></i>               <span class="opr_item_text">赞</span>             </span>             <!-- <span class="opr_item_wrp recommend_item_wrp" id="js_tail_channel_button"               style="display: none;">               <i class="opr_item video-logo_icon"></i>               <span class="opr_item_text">随便看看</span>             </span> -->           </div>         </div>          <!-- 有拓展内容 -->         <div class="have_expand" id="js_expand_area">         </div>          <!-- 广告内容 -->         <div class="ad_area" id="js_tail_video_ad_area">         </div>       </div>     </div>     <div class="feed-wrapper"><div role="dialog" aria-modal="true" aria-hidden="true" tabindex="0" class="wx_bottom_modal_wrp player_relate_video_dialog weui-half-screen-dialog_fold" hidewhensideslip="" style="visibility: hidden; display: none;"><div class="weui-half-screen-dialog wx_bottom_modal" style="max-height: none;"><div class="weui-half-screen-dialog__hd__wrp"><div class="weui-half-screen-dialog__hd"><div class="weui-half-screen-dialog__hd__side"><button class="weui-btn_icon weui-wa-hotarea">关闭<i class="weui-icon-half-screen-close"></i></button></div><div class="weui-half-screen-dialog__hd__main"><strong class="weui-half-screen-dialog__title">观看更多</strong></div><div class="weui-half-screen-dialog__hd__side"><!----><button class="weui-btn_icon weui-wa-hotarea" style="display: none;">更多<i class="weui-icon-more"></i></button></div></div></div><div class="weui-half-screen-dialog__bd"><div class="weui-loadmore" style="display: none;"><i class="weui-loading"></i></div><div class="wx_bottom_modal_msg_wrp" style="display: none;"><div class="wx_bottom_modal_msg"><i class="weui-loading"></i></div></div><div class="weui-loadmore weui-loadmore_line weui-loadmore_dot" style="display: none;"><span class="weui-loadmore__tips"></span></div><div class=""><ul id="js_player_relate_video_list" class="player_relate_video_list"></ul><div class="weui-loadmore weui-loadmore_default weui-loadmore_line weui-loadmore_dot player_video_list_end_line"><span class="weui-loadmore__tips"></span></div></div><div class="weui-loadmore" style="display: none;"><i class="weui-loading"></i></div></div><!----></div><div class="wx_bottom_modal_mask_fixed"></div><div class="weui-mask wx_bottom_modal_mask" style="opacity: 1;"></div></div><div class="js_video_fullscreen_profile video_full-screen__head video_full-screen__head_fixed" style="transform: translate3d(0px, 0px, 0px); display: none;"><div class="video_full-screen__head__inner"><div class="video_full-screen__head__body"><div class="js_video_fullscreen_profile_exit video_full-screen__head__item"><div class="video_full-screen__article-title"><button class="weui-wa-hotarea js_video_fullscreen_profile_exit reset_btn video_close_fullscreen_btn"><i class="weui-icon-close">退出全屏</i></button></div></div></div><div class="video_full-screen__head__ft"><a aria-label="更多操作" role="button" href="javascript:;" class="video_menu_more js_video_fullscreen_menu_more weui-wa-hotarea_before"><i class="weui-icon-outlined-more"></i></a></div></div></div><div class="infinity-list__wrapper" style="height: 508px;"><div class="" style="height: 508px; overflow: visible;"><div data-key="wxv_3234562720833503239" infinity-idx="0" class="infinity-list__page destory-enter" style="height: 508px; position: absolute; top: 0px; opacity: 1;"><div data-v-a63c0b2d="" class="mp-video-player" style="height: 100%;"><div data-v-3d67759b="" data-v-a63c0b2d="" id="js_mpvedio_1724240441367_1095232709516" class="js_mpvedio page_video_wrapper"><div data-v-3d67759b="" class="js_page_video page_video ratio_primary align_upper_center page_video_without-control page_video_skin-normal" style="display: block; width: 100%; height: 508px;"><svg xmlns="http://www.w3.org/2000/svg" data-v-3d67759b="" viewbox="0 0 2 2" width="4px" height="4px" class="border_filler border_filler_lefttop"><path data-v-3d67759b="" d="M1.85.005A2 2 0 000 2V0h2z" fill="#ffffff" fill-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" data-v-3d67759b="" viewbox="0 0 2 2" width="4px" height="4px" class="border_filler border_filler_righttop"><path data-v-3d67759b="" d="M1.85.005A2 2 0 000 2V0h2z" fill="#ffffff" fill-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" data-v-3d67759b="" viewbox="0 0 2 2" width="4px" height="4px" class="border_filler border_filler_rightbot"><path data-v-3d67759b="" d="M1.85.005A2 2 0 000 2V0h2z" fill="#ffffff" fill-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" data-v-3d67759b="" viewbox="0 0 2 2" width="4px" height="4px" class="border_filler border_filler_leftbot"><path data-v-3d67759b="" d="M1.85.005A2 2 0 000 2V0h2z" fill="#ffffff" fill-rule="evenodd"></path></svg><div data-v-3d67759b="" class="js_video_fullscreen_profile video_full-screen__head" style="display: none;"><div data-v-3d67759b="" class="video_full-screen__head__inner"><div data-v-3d67759b="" class="video_full-screen__head__body"><div data-v-3d67759b="" class="js_video_fullscreen_profile_exit video_full-screen__head__item"><div data-v-3d67759b="" class="video_full-screen__article-title"><button data-v-3d67759b="" class="weui-wa-hotarea js_video_fullscreen_profile_exit reset_btn video_close_fullscreen_btn" style="display: none;"><i data-v-3d67759b="" class="weui-icon-back-arrow">切换到竖屏全屏</i></button><button data-v-3d67759b="" class="weui-wa-hotarea js_video_fullscreen_profile_exit reset_btn video_close_fullscreen_btn" style="display: none;"><i data-v-3d67759b="" class="weui-icon-close">退出全屏</i></button><div data-v-3d67759b="" role="button" class="video_full-screen__account" style="display: none;"><div data-v-3d67759b="" class="video_full-screen__account-info"><span data-v-3d67759b="" class="weui-wa-hotarea video_full-screen__account-avatar" style='background: url("http://mmbiz.qpic.cn/mmbiz_png/Oh47rXadcrdibxALa66icAMaGzPic3wRPiaS3iccsMu3UTBjtHiamZMlAWcf1icpRJKqEsjLQcGfMcBnD1nlUQZVickHxg/0?wx_fmt=png") center center / cover no-repeat;'></span><span data-v-3d67759b="" class="weui-wa-hotarea video_full-screen__account-name">活水智能</span><button data-v-3d67759b="" type="button" class="reset_btn video_profile_follow_btn weui-wa-hotarea" style="display: none;">已关注</button></div></div></div></div></div><div data-v-3d67759b="" class="video_full-screen__head__ft"><div data-v-3d67759b="" class="video_sns_context" style="display: none;"><button data-v-3d67759b="" type="button" class="video_sns_btn video_sns_btn_share weui-wa-hotarea" style="display: none;"><span data-v-3d67759b="" class="video_sns_num">分享</span></button><button data-v-3d67759b="" type="button" title="" class="video_sns_btn weui-wa-hotarea video_sns_btn_praise"><span data-v-3d67759b="" class="video_sns_num">点赞</span></button><button data-v-3d67759b="" type="button" title="" class="video_sns_btn weui-wa-hotarea video_sns_btn_like"><span data-v-3d67759b="" class="video_sns_num">在看</span></button><div data-v-3d67759b="" role="alert" class="like_comment_wrp" style="display: none;"><div data-v-3d67759b="" class="like_comment_inner"><div data-v-3d67759b="" class="like_comment_bd"><div data-v-3d67759b="" class="like_comment_tips"><i data-v-3d67759b="" class="weui-icon-success"></i><i data-v-3d67759b="" class="icon-success-primary"></i>已同步到看一看<a data-v-3d67759b="" href="javascript:;" class="like_comment_share_link weui-wa-hotarea_before">写下你的评论</a></div></div></div></div></div><a data-v-3d67759b="" aria-label="更多操作" role="button" href="javascript:;" class="video_menu_more js_video_fullscreen_menu_more weui-wa-hotarea_before" style="display: none;"><i data-v-3d67759b="" class="weui-icon-outlined-more"></i></a></div></div></div><div data-v-3d67759b="" class="js_share_btn_contain top_screen_opr video_share_opr" style="display: none;"><div data-v-3d67759b="" class="wx_video_share_area"><button data-v-3d67759b="" type="button" class="js_share_btn wx_video_share_btn weui-wa-hotarea">分享视频</button></div></div><div data-v-3d67759b="" role="alert" aria-label="加载中" class="wrp_loading js_loading" style="display: none;"><span data-v-3d67759b="" class="weui-primary-loading weui-primary-loading_transparent"><span data-v-3d67759b="" class="weui-primary-loading__dot"></span></span></div><div data-v-3d67759b="" class="poster_cover" style='background-image: url("http://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrAl1KeVH35bVfScboAzw81eRjfQpz5CSWG1ll03WrgOWAibz4x7icGUCg/640?wx_fmt=jpeg&amp;wxfrom=16"); background-size: contain;'></div><div data-v-3d67759b="" class="full_screen_opr wx_video_play_opr" style=""><button data-v-3d67759b="" type="button" class="mid_play_box reset_btn"><i data-v-3d67759b="" aria-label="播放视频" class="pic_mid_play"></i><span data-v-3d67759b="" class="aria_hidden_abs">，时长</span><span data-v-3d67759b="" class="video_length">01:35</span></button></div><!----><div data-v-3d67759b="" role="alert" class="top_screen_opr wx_video_flow_wrap" style="display: none;"><div data-v-3d67759b="" class="wx_video_flow"><p data-v-3d67759b="" class="wx_video_flow_tips"></p></div></div><div data-v-3d67759b="" class="mid_opr fast_pre_next" style="display: none;"><div data-v-3d67759b="" class="video_processor_bar"><div data-v-3d67759b="" class="processor_bar_inner js_forward_bar" style="width: 0%;"></div></div><p data-v-3d67759b="" class="video_length"><span data-v-3d67759b="" class="played_time js_forward_play_time">0</span><span data-v-3d67759b="" class="js_forward_seperator">/</span><span data-v-3d67759b="" class="total_time js_forward_total_time">0</span></p></div><div data-v-3d67759b="" role="alert" class="wx_video_progress_msg full_screen_opr" style="display: none;"><div data-v-3d67759b="" class="wx_video_progress_msg_inner"><span data-v-3d67759b="" class="wx_video_progress_current">00:00</span><span data-v-3d67759b="" class="wx_video_progress_gap">/</span><span data-v-3d67759b="" class="wx_video_progress_total">01:35</span></div></div><div data-v-3d67759b="" class="video_fullscreen_mask" style="display: none;"></div><div data-v-3d67759b="" class="video_screen_mode_switch" style="bottom: calc(50% - 351.85px); display: none;"><button data-v-3d67759b="" type="button" class="reset_btn video_screen_mode_switch_btn weui-wa-hotarea"> 切换到横屏模式 </button></div><div data-v-3d67759b="" class="full_screen_opr wx_video_pause_full_mod" style="display: none;"><button data-v-3d67759b="" type="button" class="reset_btn wx_video_pause_full_btn">继续播放</button></div><input data-v-3d67759b="" type="checkbox" title="显示工具栏" class="aria_hidden_abs" aria-hidden="true"><div data-v-3d67759b="" class="js_control video_opr video_opr_normal padding_play_bar"><div data-v-3d67759b="" class="opr_inner"><div data-v-3d67759b="" class="opr_inner_fl"><div data-v-3d67759b="" class="js_play_bar_wrapper wrp_play_bar wrp_play_bar_hide_speed-dot" style="display: none;"><div data-v-3d67759b="" class="js_progress_bar wrp_progress" style="padding-top: 10px; padding-bottom: 0px;"><div data-v-3d67759b="" class="progress_bar"><div data-v-3d67759b="" class="background_bar"></div><div data-v-3d67759b="" role="option" aria-labelledby="ariaPlayedCurrent" title="按住可调" class="js_played_bar played_bar" style="width: 0%;"><span data-v-3d67759b="" id="ariaPlayedCurrent" class="aria_hidden_abs">进度条，百分之0</span></div><div data-v-3d67759b="" class="js_buffer_bar buffer_bar" style="width: 0%;"></div><!----><div data-v-3d67759b="" class="weui-wa-hotarea js_played_speed_cnt wrp_speed_dot" style="left: 0%;"><i data-v-3d67759b="" class="speed_dot"></i></div></div></div></div></div></div></div><div data-v-3d67759b="" class="js_control video_opr video_opr_sns" style="display: none;"><div data-v-3d67759b="" class="opr_inner"><div data-v-3d67759b="" class="opr_inner_fl"><div data-v-3d67759b="" class="js_switch weui-wa-hotarea switch switch_on"><a data-v-3d67759b="" href="javascript:;" role="button" class="btn_opr">播放</a></div><div data-v-3d67759b="" role="option"><div data-v-3d67759b="" class="played_time js_now_play_time">00:00</div><span data-v-3d67759b="">/</span><div data-v-3d67759b="" class="total_time js_total_time">01:35</div></div><!----><div data-v-3d67759b="" role="option" class="total_time js_total_time" style="display: none;">01:35</div></div><div data-v-3d67759b="" class="opr_inner_fr"><!----><!----><!----><div data-v-3d67759b="" role="button" class="weui-wa-hotarea js_full_screen_control screenSize_control full"><i data-v-3d67759b="" class="icon_control">全屏</i></div></div></div></div><div data-v-3d67759b="" class="js-toast weui-toast weui-toast_text" role="alert" style="display: none;"><p class="weui-toast__content"></p></div><div data-v-3d67759b="" role="alert" class="full_screen_opr video_quick_play_context" style="display: none;"><div data-v-3d67759b="" class="video_quick_play_msg"><i data-v-3d67759b="" class="icon_video_quick_play"></i> 倍速播放中 </div></div><div data-v-3d67759b="" class="js_sub_setting video_full-screen__footer video_full-screen__footer__sub-setting hide"><div data-v-3d67759b="" class="video_full-screen__sub-setting video_full-screen__sub-setting__speed js_playback_mode_select" style="display: none;"><a data-v-3d67759b="" href="javascript:;" class="video_full-screen__sub-setting__item js_playback_0"> 0.5倍 </a><a data-v-3d67759b="" href="javascript:;" class="video_full-screen__sub-setting__item js_playback_1"> 0.75倍 </a><a data-v-3d67759b="" href="javascript:;" class="video_full-screen__sub-setting__item current js_playback_2"> 1.0倍 </a><a data-v-3d67759b="" href="javascript:;" class="video_full-screen__sub-setting__item js_playback_3"> 1.5倍 </a><a data-v-3d67759b="" href="javascript:;" class="video_full-screen__sub-setting__item js_playback_4"> 2.0倍 </a></div><div data-v-3d67759b="" class="video_full-screen__sub-setting video_full-screen__sub-setting__ratio js_play_mode_select" style="display: none;"><a data-v-3d67759b="" href="javascript:;" class="video_full-screen__sub-setting__item current js_resolution_0"> 流畅 </a></div></div><div data-v-3d67759b="" class="js_inner inner not_fullscreen"><div data-v-3d67759b="" class="js_video_poster video_poster" style="display: none;"><div data-v-3d67759b="" class="video_mask"></div><video data-v-3d67759b="" src="https://mpvideo.qpic.cn/0bc32aaa4aaa6eafb43yejsvbugdb3iaadqa.f10102.mp4?dis_k=f8f19f515b563ca32798a95683c51610&amp;dis_t=1724240225&amp;play_scene=10120&amp;auth_info=fNCJ0ZR/d0dCjs3dzxgmTTFGS2hbfjowRhhkNExsbmlBPj8WM0xdcWtBU0x3ITVdOUFKOAVnBR4TUG9vEDd5ZVo/&amp;auth_key=33820d2abfef2adf799a1b60265a47c1&amp;vid=wxv_3234562720833503239&amp;format_id=10102&amp;support_redirect=0&amp;mmversion=false" poster="http://mmbiz.qpic.cn/mmbiz_jpg/qbGEP2AGDVV7JicJm2XTU5bWetY31ibaQrAl1KeVH35bVfScboAzw81eRjfQpz5CSWG1ll03WrgOWAibz4x7icGUCg/0?wx_fmt=jpeg&amp;wxfrom=16" webkit-playsinline="isiPhoneShowPlaysinline" playsinline="isiPhoneShowPlaysinline" preload="metadata" crossorigin="anonymous" controlslist="nodownload" class="video_fill"> 您的浏览器不支持 video 标签 </video></div><div data-v-a63c0b2d="" data-v-3d67759b="" class="video_poster__info__play" style="display: none;"><i data-v-a63c0b2d="" data-v-3d67759b="" class=""></i></div><div data-v-a63c0b2d="" data-v-3d67759b="" class="video_poster__info" style="display: none;"><p data-v-a63c0b2d="" data-v-3d67759b="" class="video_poster__info__title" style="font-size: 17px;">继续观看</p><p data-v-a63c0b2d="" data-v-3d67759b="" class="video_poster__info__desc" style="font-size: 12px;"> 活水教程｜MLX 框架使用案例 </p></div><div data-v-a63c0b2d="" data-v-3d67759b="" class="video_poster__info__mask" style="width: 100%; display: none;"></div></div><div data-v-3d67759b="" class="video_profile_area" style="display: none;"><div data-v-3d67759b=""><button data-v-a63c0b2d="" class="reset_btn video_profile_relate_video_btn js_wx_tap_highlight wx_tap_link" data-v-3d67759b="" style="display: none;">观看更多<i class="weui-icon-filled-arrow video_profile_relate_video_btn_arrow"></i></button></div><div data-v-3d67759b="" role="link" tabindex="0" style="width: fit-content; max-width: 100%;"><div data-v-3d67759b="" role="option" class="weui-wa-hotarea video_profile_desc_wrp"><div data-v-3d67759b="" class="icon_appmsg_tag_wrp" style="display: none;"><div data-v-3d67759b="" class="icon_appmsg_tag">转载</div></div><div data-v-3d67759b="" class="weui-hidden_abs">,</div><div data-v-3d67759b="" class="video_profile_desc">活水教程｜MLX 框架使用案例</div><i data-v-3d67759b="" class="weui-icon-outlined-arrow video_profile_desc_arrow"></i></div></div><div data-v-3d67759b="" class="video_profile_wrp weui-flex"><div data-v-3d67759b="" class="video_profile weui-flex weui-flex__item"><span data-v-3d67759b="" class="video_profile_avatar weui-wa-hotarea" style='background: url("http://mmbiz.qpic.cn/mmbiz_png/Oh47rXadcrdibxALa66icAMaGzPic3wRPiaS3iccsMu3UTBjtHiamZMlAWcf1icpRJKqEsjLQcGfMcBnD1nlUQZVickHxg/0?wx_fmt=png") center center / cover no-repeat;'></span><span data-v-3d67759b="" class="video_profile_nickname weui-wa-hotarea">活水智能</span><button data-v-3d67759b="" type="button" class="reset_btn video_profile_follow_btn weui-wa-hotarea" style="display: none;">已关注</button></div><div data-v-3d67759b="" class="video_sns_context" style="display: none;"><button data-v-3d67759b="" type="button" class="video_sns_btn video_sns_btn_share" style="display: none;"><span data-v-3d67759b="" class="video_sns_num">分享</span></button><button data-v-3d67759b="" type="button" title="" class="video_sns_btn video_sns_btn_praise"><span data-v-3d67759b="" class="video_sns_num">点赞</span></button><button data-v-3d67759b="" type="button" title="" class="video_sns_btn video_sns_btn_like"><span data-v-3d67759b="" class="video_sns_num">在看</span></button></div><div data-v-3d67759b="" role="alert" class="like_comment_wrp" style="display: none;"><div data-v-3d67759b="" class="like_comment_inner"><div data-v-3d67759b="" class="like_comment_bd"><div data-v-3d67759b="" class="like_comment_tips"><i data-v-3d67759b="" class="weui-icon-success"></i><i data-v-3d67759b="" class="icon-success-primary"></i>已同步到看一看<a data-v-3d67759b="" href="javascript:;" class="like_comment_share_link weui-wa-hotarea_before">写下你的评论</a></div></div></div></div></div></div></div></div><div data-v-a63c0b2d="" style="display: none;"><div data-v-a63c0b2d="" class="weui-mask_transparent"></div><div data-v-a63c0b2d="" class="weui-toast" style="top: 45%; position: absolute;"><i data-v-a63c0b2d="" class="weui-icon-success-no-circle weui-icon_toast"></i><p data-v-a63c0b2d="" class="weui-toast__content"></p></div></div><div data-v-a63c0b2d="" class="fullscreen-screenshot__layer" style="background-color: rgb(0, 0, 0); display: none;"></div><div data-v-a63c0b2d="" class="fullscreen-screenshot__layer" style='z-index: -1; background-image: url(""); display: none;'></div></div></div></div></div><audio loop="loop" preload="auto" style="display: none;"><source src="https://res.wx.qq.com/voice/getvoice?mediaid=MzA3MzA0MTAyNF8xMDAwMDI3Njk="></source></audio><!----></div>   </div>   <!--E 视频播放器-->   <!-- S 视频社交-->   <div id="bottom_bar" class="interact_video" style="display:none;height: 35px;">     <div class="inter_opr">       <a id="video_detail_btn" href="javascript:;" target="_blank" class="access_original">         视频详情       </a>     </div>   </div> </div></span></section><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin: 10px 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'><span style="color: rgb(97, 174, 238);"># </span>下载示例仓库<br><br>git clone https://github.com/ml-explore/mlx-examples.git &amp;&amp; cd mlx-examples/mistral<br><span style="color: rgb(97, 174, 238);"><br># </span>此时记得开个 Python 虚拟环境<br><span style="color: rgb(97, 174, 238);"># </span>安装 Python 依赖<br><br>pip install -r requirements.txt<br><span style="color: rgb(97, 174, 238);"><br># </span>下载模型，大概 14gb 左右<br><br>curl -O https://files.mistral-7b-v0-1.mistral.ai/mistral-7B-v0.1.tar<br><span style="color: rgb(97, 174, 238);"><br># </span>解压缩模型与转换模型<br>tar -xf mistral-7B-v0.1.tar<br>python convert.py<br><span style="color: rgb(97, 174, 238);"><br># </span>推理模型<br>python mistral.py --prompt "It is a truth universally acknowledged,"  --temp 0</code></pre><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>我的配置是 M2 Max 64g，初步测试，目前 MLX 原生没看到量化的推理，就只能和 llama.cpp 比较 F16 精度了，此时：</p><ul xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;list-style: circle;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>• llama.cpp 一秒钟大概 24 个 Tokens。</p></li><li style="text-align: left;line-height: 1.75;text-indent: -1em;display: block;margin: 0.2em 8px;"><p>• MLX 一秒钟大概 30 个 Tokens。大概快 15-30%。</p></li></ul><h2 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.4px;font-weight: bold;display: table;margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);color: rgb(255, 255, 255);'>Stable Diffusion 图像生成性能</h2><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>目前在 Batch size 为 1 的时候 PyTorch 会更加快，但在 Batch size 提高的时候，MLX 会胜过 PyTorch。下面的表格详细展示了性能对比。</p><table xmlns="http://www.w3.org/1999/xhtml"><tbody><tr height="31"><td width="65" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;font-weight: 600;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);text-align: center;"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">Batch size</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;font-weight: 600;vertical-align: middle;word-break: break-all;color: rgb(31, 35, 40);text-align: center;"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">PyTorch</span></section></td><td width="110" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;font-weight: 600;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);text-align: center;"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">MLX</span></section></td></tr><tr height="31"><td data-sheet-value="1" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">1</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">6.25 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">4.17 im/s</span></section></td></tr><tr height="31"><td data-sheet-value="2" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">2</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">7.14 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">5.88 im/s</span></section></td></tr><tr height="31"><td data-sheet-value="4" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">4</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;font-weight: 600;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">7.69 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">7.14 im/s</span></section></td></tr><tr height="31"><td data-sheet-value="6" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">6</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">7.22 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">8.00 im/s</span></section></td></tr><tr height="31"><td data-sheet-value="8" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">8</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">6.89 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">8.42 im/s</span></section></td></tr><tr height="31"><td data-sheet-value="12" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">12</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">6.62 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">8.51 im/s</span></section></td></tr><tr height="31"><td data-sheet-value="16" width="85" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">16</span></section></td><td width="119" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;vertical-align: middle;word-break: break-word;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">6.32 im/s</span></section></td><td width="90" style="border-color: rgb(222, 224, 227);white-space-collapse: preserve;font-size: 12pt;font-weight: 600;vertical-align: middle;word-break: break-all;color: rgb(31, 35, 40);"><section style="margin-right: 8px;margin-left: 8px;"><span style="font-size: 15px;color: rgb(63, 63, 63);">8.79 im/s</span></section></td></tr></tbody></table><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>请注意，上表意味着使用 MLX 和无分类器引导的 50 个扩散步骤生成 16 张图像大约需要 90 秒，而使用 PyTorch 则需要大约 120 秒。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>对于测试感兴趣的小伙伴可以参考 https://github.com/ml-explore/mlx-examples/tree/main/stable_diffusion。</p><h1 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.96px;font-weight: bold;display: table;margin: 2em auto 1em;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);color: rgb(63, 63, 63);'>Known Issues</h1><h2 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.4px;font-weight: bold;display: table;margin: 4em auto 2em;padding-right: 0.2em;padding-left: 0.2em;background: rgb(15, 76, 129);color: rgb(255, 255, 255);'>M1 Max 不支持</h2><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>Wing 尝试在 M1 Max 上进行操作，但这个 https://github.com/ml-explore/mlx/issues/20 似乎说了 M1Max 未能支持，直接 <code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">pip install mlx</code> 也会报错，另外参考：https://ml-explore.github.io/mlx/build/html/install.html。</p><p xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;margin: 1.5em 8px;letter-spacing: 0.1em;color: rgb(63, 63, 63);'>直接执行 <code style="line-height: 1.75;font-size: 12.6px;color: rgb(221, 17, 68);background: rgba(27, 31, 35, 0.05);padding: 3px 5px;border-radius: 4px;word-break: break-all;">pip install mlx</code> 可能会遇到：</p><pre xmlns="http://www.w3.org/1999/xhtml" style='color: rgb(171, 178, 191);background: rgb(40, 44, 52);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin: 10px 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'>ERROR: Could <span style="color: rgb(198, 120, 221);">not</span> find a version that satisfies the requirement mlx (<span style="color: rgb(198, 120, 221);">from</span> versions: none)<br>ERROR: No matching distribution found <span style="color: rgb(198, 120, 221);">for</span> mlx</code></pre><blockquote xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;border-left: none;padding: 1em;border-radius: 8px;background: rgb(247, 247, 247);margin: 2em 8px;'><p style='line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 1em;letter-spacing: 0.1em;color: rgb(80, 80, 80);'>MLX is only available on devices running MacOS &gt;= 13.3 It is highly recommended to use MacOS 14 (Sonoma)<span style='color: rgba(0, 0, 0, 0.9);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: var(--articleFontsize);letter-spacing: 0.034em;text-align: justify;'></span><span style='color: rgba(0, 0, 0, 0.9);font-family: mp-quote, -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: var(--articleFontsize);letter-spacing: 0.034em;text-align: justify;'></span></p></blockquote><h1 xmlns="http://www.w3.org/1999/xhtml" style='letter-spacing: normal;text-wrap: wrap;text-align: center;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;font-size: 15.96px;font-weight: bold;display: table;margin: 2em auto 1em;padding-right: 1em;padding-left: 1em;border-bottom: 2px solid rgb(15, 76, 129);color: rgb(63, 63, 63);'>Reference</h1><ul xmlns="http://www.w3.org/1999/xhtml" style='font-size: 14px;letter-spacing: normal;text-wrap: wrap;text-align: left;line-height: 1.75;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;padding-left: 1em;list-style: circle;color: rgb(63, 63, 63);' class="list-paddingleft-1"><li><pre style='color: rgb(36, 41, 46);background: rgb(255, 255, 255);font-size: 14px;letter-spacing: normal;text-align: left;line-height: 1.5;font-family: -apple-system-font, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;overflow-x: auto;border-radius: 8px;padding: 1em;margin-right: 8px;margin-bottom: 10px;margin-left: 8px;'><code style='line-height: 1.75;font-family: Menlo, "Operator Mono", Consolas, Monaco, monospace;white-space-collapse: collapse;'>• https://twitter.com/awnihannun/status/1732184443451019431<br>• https://github.com/ml-explore/mlx<br>• https://github.com/ml-explore/mlx-examples<br>• https://github.com/ml-explore/mlx/issues/12</code></pre></li></ul><p xmlns="http://www.w3.org/1999/xhtml" style="margin-top: 20px;padding: 0.8em 1.2em;text-wrap: wrap;outline-style: initial;font-size: 14px;letter-spacing: 1px;word-spacing: 1px;line-height: 1.6em;font-family: Arial, sans;"><strong style="caret-color: red;"><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder" data-galleryid="" data-imgfileid="100001274" data-ratio="0.08" data-s="300,640" data-src="https://mmbiz.qpic.cn/mmbiz_png/qbGEP2AGDVVj0WO28C0GycQhsG7gB0Lmx6UTsWcdia8xSdOfZ7V3N4CF4XNGa6qhDJ1vPhQoQicI53uoRdE4K2ibA/640?wx_fmt=png" data-type="png" data-w="900" style='outline-style: initial; cursor: pointer; font-size: 17px; letter-spacing: 0.544px; text-align: center; font-family: system-ui, -apple-system, system-ui, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; visibility: visible !important; width: 544.406px !important; height: 43.5525px !important;' data-original-style='outline-style: initial;cursor: pointer;font-size: 17px;letter-spacing: 0.544px;text-align: center;width: 544.406px;font-family: system-ui, -apple-system, system-ui, "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;visibility: visible !important;' data-index="5" src="https://mmbiz.qpic.cn/mmbiz_png/qbGEP2AGDVVj0WO28C0GycQhsG7gB0Lmx6UTsWcdia8xSdOfZ7V3N4CF4XNGa6qhDJ1vPhQoQicI53uoRdE4K2ibA/640?wx_fmt=png" _width="544.406px" crossorigin="anonymous" alt="图片"></strong></p><section xmlns="http://www.w3.org/1999/xhtml" style='text-wrap: wrap; outline-style: initial; letter-spacing: 0.544px; font-family: system-ui, -apple-system, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif; margin-bottom: 0px;'><section style="outline-style: initial;"><section class="mp_profile_iframe_wrp"><mp-common-profile class="js_uneditable custom_select_card mp_profile_iframe mp_common_widget js_wx_tap_highlight" data-pluginname="mpprofile" data-id="MzkzODQ5ODg5Ng==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/qbGEP2AGDVUSUkAfyKgZicaCrZuXcbMXwEwcrVVByVUibHQQe1gX0aEw4SsBE9uv09DFRcXbFCQEZlE9D1K1PRzw/300?wx_fmt=png&amp;wxfrom=19" data-nickname="未命名公众号" data-alias="" data-signature="活水智能是一家致力于通过人工智能提高知识工作者的生产力的公司，我们的口号是“AI时代的生产力专家”。我们的核心目标是为用户提供最先进的AI技术和工具，从而帮助他们更高效、更智能地进行工作。" data-from="0" data-is_biz_ban="0" data-origin_num="0" data-isban="0" data-biz_account_status="1" data-index="0"></mp-common-profile></section><section style='caret-color: rgb(255, 0, 0);border-width: 0px;border-style: none;border-color: initial;z-index: 0;width: 578px;letter-spacing: 0.578px;font-family: mp-quote, -apple-system-font, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;max-inline-size: 100%;outline: none 0px !important;'><strong style="color: rgb(0, 0, 0);font-size: 14px;letter-spacing: 1px;word-spacing: 1px;cursor: text;font-family: Arial, sans;max-inline-size: 100%;outline: none 0px !important;"></strong></section><section style='caret-color: rgb(255, 0, 0);border-width: 0px;border-style: none;border-color: initial;z-index: 0;width: 578px;letter-spacing: 0.578px;font-family: mp-quote, -apple-system-font, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;max-inline-size: 100%;outline: none 0px !important;'><strong style="color: rgb(0, 0, 0);font-size: 14px;letter-spacing: 1px;word-spacing: 1px;cursor: text;font-family: Arial, sans;max-inline-size: 100%;outline: none 0px !important;"><br></strong></section><section style='caret-color: rgb(255, 0, 0);border-width: 0px;border-style: none;border-color: initial;z-index: 0;width: 578px;letter-spacing: 0.578px;font-family: mp-quote, -apple-system-font, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;max-inline-size: 100%;outline: none 0px !important;'><strong style="color: rgb(0, 0, 0);font-size: 14px;letter-spacing: 1px;word-spacing: 1px;cursor: text;font-family: Arial, sans;max-inline-size: 100%;outline: none 0px !important;">活水智能</strong><span style="color: rgb(0, 0, 0);font-size: 14px;letter-spacing: 1px;word-spacing: 1px;font-family: Arial, sans;">致力于通过人工智能提高知识工作者的生产力，作为「AI时代的生产力专家」，我们的核心目标是为用户提供最先进的AI技术和工具，帮助用户更高效、更智能地完成工作。</span></section><section style='caret-color: rgb(255, 0, 0);border-width: 0px;border-style: none;border-color: initial;z-index: 0;width: 578px;letter-spacing: 0.578px;font-family: mp-quote, -apple-system-font, "system-ui", "Helvetica Neue", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei UI", "Microsoft YaHei", Arial, sans-serif;max-inline-size: 100%;margin-left: 0px;margin-right: 0px;outline: none 0px !important;'><span style="color: rgb(0, 0, 0);font-size: 14px;letter-spacing: 1px;word-spacing: 1px;font-family: Arial, sans;"></span></section></section></section><p xmlns="http://www.w3.org/1999/xhtml" style="display: none;"><mp-style-type data-value="3"></mp-style-type></p></body>
</html>